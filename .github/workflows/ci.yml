# æ–‡ä»¶åï¼š.github/workflows/ci.yml å‘å¸ƒåˆ°npm èŠ‚çœé‡å¤æ“ä½œï¼ˆä¸éœ€è¦æ‰‹åŠ¨æ‰“åŒ… & å‘å¸ƒï¼‰ç»“åˆ Changesets å¯å®ç°è‡ªåŠ¨è¯­ä¹‰åŒ–å‘å¸ƒ
# åç§°ï¼šCIï¼ˆæŒç»­é›†æˆï¼‰ğŸ“¦ æ¯”å¦‚ï¼šæ¯æ¬¡ä½ åˆå¹¶ release åˆ†æ”¯ï¼Œå°±è‡ªåŠ¨æ‰“åŒ…å‘å¸ƒ @xzl/ui åˆ° npm
name: CI

# è§¦å‘æ¡ä»¶ï¼šå½“ä»£ç  push æˆ– pull request åˆ° release åˆ†æ”¯æ—¶è§¦å‘
on:
  push:
    branches: [release]       # å½“æœ‰æäº¤æ¨é€åˆ° release åˆ†æ”¯
  pull_request:
    branches: [release]       # å½“æœ‰ PR åˆå¹¶åˆ° release åˆ†æ”¯

jobs:
  install-and-test:           # ä½œä¸šåç§°ï¼šå®‰è£…ä¾èµ–å¹¶æ‰§è¡Œæµ‹è¯•
    runs-on: ubuntu-latest    # è¿è¡Œç¯å¢ƒï¼šåœ¨æœ€æ–°ç‰ˆçš„ Ubuntu Linux ä¸Šè¿è¡Œ

    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        # æ­¥éª¤ 1ï¼šæ‹‰å–ä»£ç ä»“åº“å†…å®¹ï¼ˆé»˜è®¤ä¼šæ‹‰å½“å‰ commitï¼‰

      - name: Set up pnpm
        uses: pnpm/action-setup@v2
        with:
          version: 8
        # æ­¥éª¤ 2ï¼šè®¾ç½® pnpm åŒ…ç®¡ç†å™¨å¹¶æŒ‡å®šä½¿ç”¨ç‰ˆæœ¬ 8

      - name: Install dependencies
        run: pnpm install
        # æ­¥éª¤ 3ï¼šå®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆMonorepo é¡¹ç›®ä¼šè‡ªåŠ¨é€’å½’å®‰è£…ï¼‰

      - name: Run lint, test, build
        run: pnpm turbo run lint test build
        # æ­¥éª¤ 4ï¼šé€šè¿‡ turbo æ‰§è¡Œ lintã€testã€build ä¸‰ä¸ªä»»åŠ¡
        # --filter=... è¡¨ç¤ºä¼šå¯¹æ‰€æœ‰å—å½±å“çš„é¡¹ç›®è¿›è¡Œæ“ä½œï¼ˆä¾‹å¦‚åœ¨ PR ä¸­è¢«æ”¹åŠ¨çš„åŒ…ï¼‰
        # turbo ä¼šæ ¹æ®ä¾èµ–å…³ç³»è‡ªåŠ¨åˆ¤æ–­å“ªäº›å­åŒ…å—å½±å“